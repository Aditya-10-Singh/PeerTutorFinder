(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[386],{4868:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(5155),r=s(2115),c=s(8475),d=s(6203),l=s(5317),i=s(6874),n=s.n(i);function o(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)({}),[o,u]=(0,r.useState)({uid:"",role:"",subjects:[]}),[m,x]=(0,r.useState)("");(0,r.useEffect)(()=>{let e=(0,d.hg)(c.j,async e=>{if(e){let t=(await (0,l.GG)((0,l.P)((0,l.rJ)(c.db,"users"),(0,l._M)("__name__","==",e.uid)))).docs[0].data();u({uid:e.uid,role:t.role,subjects:t.subjects||[]}),await b(),await h()}else window.location.href="/login"});return()=>e()},[]);let b=async()=>{let e=await (0,l.GG)((0,l.P)((0,l.rJ)(c.db,"users"),(0,l._M)("role","==","Tutor"))),t={};e.forEach(e=>{t[e.id]=e.data().name}),i(t)},h=async()=>{let e=(0,l.P)((0,l.rJ)(c.db,"doubts"),(0,l.My)("createdAt","desc")),s=await (0,l.GG)(e),a=[];s.forEach(e=>{let t=e.data();a.push({id:e.id,title:t.title,description:t.description,subject:t.subject,createdAt:t.createdAt,name:t.name,recommendedTutors:t.recommendedTutors||[],acceptedTutors:t.acceptedTutors||[]})}),t(a)},p=async e=>{if(!o.uid)return;let t=(0,l.H9)(c.db,"doubts",e),s=(await (0,l.GG)((0,l.P)((0,l.rJ)(c.db,"doubts"),(0,l._M)("__name__","==",e)))).docs[0].data().acceptedTutors||[];if(!s.includes(o.uid)){let e=[...s,o.uid];await (0,l.mZ)(t,{acceptedTutors:e}),alert("You accepted this doubt!"),await h()}},j=Array.from(new Set(e.map(e=>e.subject))),f=m?e.filter(e=>e.subject===m):e;return(0,a.jsxs)("main",{className:"flex flex-col items-center justify-start min-h-screen p-4 w-full",children:[(0,a.jsx)(n(),{href:"/dashboard",className:"text-blue-500 underline mb-4",children:"← Back to Dashboard"}),(0,a.jsx)("h1",{className:"text-2xl mb-4",children:" All Learner Doubts"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"mr-2 font-semibold",children:"Filter by Subject:"}),(0,a.jsxs)("select",{value:m,onChange:e=>x(e.target.value),className:"border p-1",children:[(0,a.jsx)("option",{value:"",children:"All"}),j.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),0===f.length&&(0,a.jsx)("p",{className:"text-gray-600",children:"No doubts match your filter."}),(0,a.jsx)("div",{className:"w-full max-w-2xl flex flex-col gap-4",children:f.map(e=>{var t;return(0,a.jsxs)("div",{className:"border p-4 rounded shadow-sm bg-white",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-600",children:e.title}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Subject: ",e.subject]}),(0,a.jsx)("p",{className:"mt-2 font-bold text-gray-600",children:e.description}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Posted by: ",e.name," ",(0,a.jsx)("br",{}),(null==(t=e.createdAt)?void 0:t.toDate)?e.createdAt.toDate().toLocaleString():"Just now"]}),(0,a.jsx)("h3",{className:"mt-2 font-semibold text-sm text-gray-600",children:"Matched Tutors:"}),0===e.recommendedTutors.length&&0===e.acceptedTutors.length?(0,a.jsx)("p",{className:"text-xs text-red-500",children:"⏳ Pending — No match yet"}):(0,a.jsx)(a.Fragment,{children:e.recommendedTutors.length>0&&(0,a.jsx)("ul",{className:"list-disc ml-5 text-xs",children:e.recommendedTutors.map(e=>(0,a.jsx)("li",{children:s[e]||"Tutor ID: ".concat(e)},e))})}),"Tutor"===o.role&&o.subjects.includes(e.subject)&&(0,a.jsx)("button",{onClick:()=>p(e.id),className:"mt-3 bg-blue-500 text-white text-xs px-2 py-1 rounded",children:"✅ Accept Doubt"}),e.acceptedTutors.length>0&&(0,a.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["Accepted by:"," ",e.acceptedTutors.map(e=>s[e]||"Tutor ID: ".concat(e)).join(", ")]})]},e.id)})})]})}},7657:(e,t,s)=>{Promise.resolve().then(s.bind(s,4868))},8475:(e,t,s)=>{"use strict";let a;s.d(t,{db:()=>i,j:()=>l});var r=s(3915),c=s(6203),d=s(5317);r.Wp.length,a=(0,r.Wp)({apiKey:"AIzaSyAmB_wDxvKkrbD3G8e3qqldfvUIaqke-gs",authDomain:"peertutorfinder.firebaseapp.com",projectId:"peertutorfinder",storageBucket:"peertutorfinder.firebasestorage.app",messagingSenderId:"861946198169",appId:"1:861946198169:web:55369d32dda12c14f62008"});let l=(0,c.xI)(a),i=(0,d.aU)(a)}},e=>{var t=t=>e(e.s=t);e.O(0,[992,811,645,874,441,684,358],()=>t(7657)),_N_E=e.O()}]);