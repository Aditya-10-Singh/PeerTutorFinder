(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{3825:(e,t,s)=>{Promise.resolve().then(s.bind(s,5102))},5102:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(5155),d=s(2115),n=s(6203),i=s(8475),r=s(5695),l=s(5317),c=s(6874),o=s.n(c);function u(){let e=(0,r.useRouter)(),[t,s]=(0,d.useState)(null),[c,u]=(0,d.useState)(""),[m,x]=(0,d.useState)([]),[b,h]=(0,d.useState)({}),[f,p]=(0,d.useState)({}),[j,y]=(0,d.useState)({}),[w,N]=(0,d.useState)({});(0,d.useEffect)(()=>{let t=(0,n.hg)(i.j,async t=>{if(t){let e=await (0,l.x7)((0,l.H9)(i.db,"users",t.uid)),a=e.exists()?e.data().name:"User";s({uid:t.uid,name:a})}else e.push("/login")});return()=>t()},[e]),(0,d.useEffect)(()=>{t&&g()},[t]);let g=async()=>{let e=(0,l.P)((0,l.rJ)(i.db,"communityPosts"),(0,l.My)("createdAt","desc")),s=await (0,l.GG)(e),a=[],d={},n={},r={};for(let e of s.docs){let s=e.data(),c=e.id;a.push({id:c,uid:s.uid,name:s.name,content:s.content,createdAt:s.createdAt});let o=await (0,l.GG)((0,l.rJ)(i.db,"communityPosts",c,"likes"));if(d[c]=o.size,t){let e=await (0,l.x7)((0,l.H9)(i.db,"communityPosts",c,"likes",t.uid));n[c]=e.exists()}let u=(0,l.P)((0,l.rJ)(i.db,"communityPosts",c,"comments"),(0,l.My)("createdAt","asc")),m=await (0,l.GG)(u),x=[];m.forEach(e=>{let t=e.data();x.push({id:e.id,uid:t.uid,name:t.name,content:t.content,createdAt:t.createdAt})}),r[c]=x}x(a),y(d),N(n),h(r)},v=async e=>{e.preventDefault(),t&&(await (0,l.gS)((0,l.rJ)(i.db,"communityPosts"),{uid:t.uid,name:t.name,content:c,createdAt:(0,l.O5)()}),u(""),g())},k=async e=>{var s;if(!t)return;let a=null==(s=f[e])?void 0:s.trim();a&&(await (0,l.gS)((0,l.rJ)(i.db,"communityPosts",e,"comments"),{uid:t.uid,name:t.name,content:a,createdAt:(0,l.O5)()}),p(t=>({...t,[e]:""})),g())},P=async e=>{if(!t)return;let s=(0,l.H9)(i.db,"communityPosts",e,"likes",t.uid);(await (0,l.x7)(s)).exists()?await (0,l.kd)(s):await (0,l.BN)(s,{uid:t.uid,createdAt:(0,l.O5)()}),g()},A=async e=>{await (0,l.kd)((0,l.H9)(i.db,"communityPosts",e)),g()};return(0,a.jsxs)("main",{className:"flex flex-col items-center justify-center min-h-screen p-4 w-full",children:[(0,a.jsx)(o(),{href:"/dashboard",className:"text-blue-500 underline mb-4",children:"← Back to Dashboard"}),(0,a.jsx)("h1",{className:"text-3xl mb-4",children:"Community Connect"}),(0,a.jsxs)("form",{onSubmit:v,className:"w-full max-w-md mb-8",children:[(0,a.jsx)("textarea",{value:c,onChange:e=>u(e.target.value),placeholder:"Describe your project, idea, or collab goal...",className:"border w-full p-2 mb-2",required:!0}),(0,a.jsx)("button",{type:"submit",className:"bg-green-500 text-white p-2 rounded",children:"Post"})]}),(0,a.jsxs)("div",{className:"w-full max-w-md",children:[(0,a.jsx)("h2",{className:"text-xl mb-2",children:"Latest Collaboration Posts"}),0===m.length&&(0,a.jsx)("p",{children:"No community posts yet. Be the first!"}),m.map(e=>{var s,d;return(0,a.jsxs)("div",{className:"border p-4 mb-4 rounded",children:[(0,a.jsx)("p",{className:"font-bold",children:e.name}),(0,a.jsx)("p",{children:e.content}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:(null==(s=e.createdAt)?void 0:s.toDate)?e.createdAt.toDate().toLocaleString():"Just now"}),(0,a.jsxs)("button",{onClick:()=>P(e.id),className:"text-sm mt-2 ".concat(w[e.id]?"text-blue-500":"text-gray-600"),children:[w[e.id]?"❤️ Liked":"\uD83E\uDD0D Like"," (",j[e.id]||0,")"]}),t&&e.uid===t.uid&&(0,a.jsx)("button",{onClick:()=>A(e.id),className:"text-red-500 text-xs ml-4",children:"Delete Post"}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold mb-2",children:"Comments"}),null==(d=b[e.id])?void 0:d.map(e=>(0,a.jsxs)("div",{className:"border-t py-1 text-sm",children:[(0,a.jsxs)("span",{className:"font-bold",children:[e.name,": "]}),(0,a.jsx)("span",{children:e.content})]},e.id)),(0,a.jsx)("textarea",{value:f[e.id]||"",onChange:t=>p(s=>({...s,[e.id]:t.target.value})),placeholder:"Add a comment...",className:"border w-full p-1 mt-2 text-sm"}),(0,a.jsx)("button",{onClick:()=>k(e.id),className:"text-blue-500 text-xs mt-1",children:"Add Comment"})]})]},e.id)})]})]})}},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},8475:(e,t,s)=>{"use strict";let a;s.d(t,{db:()=>l,j:()=>r});var d=s(3915),n=s(6203),i=s(5317);d.Wp.length,a=(0,d.Wp)({apiKey:"AIzaSyAmB_wDxvKkrbD3G8e3qqldfvUIaqke-gs",authDomain:"peertutorfinder.firebaseapp.com",projectId:"peertutorfinder",storageBucket:"peertutorfinder.firebasestorage.app",messagingSenderId:"861946198169",appId:"1:861946198169:web:55369d32dda12c14f62008"});let r=(0,n.xI)(a),l=(0,i.aU)(a)}},e=>{var t=t=>e(e.s=t);e.O(0,[992,811,645,874,441,684,358],()=>t(3825)),_N_E=e.O()}]);